---
title: "calculation"
author: "Yuka Chen"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE,
  warning = FALSE,
  results = "hide"
)

```

```{r}
library(tidyverse)
inboundcall <- read_csv("clean-data/inbound_call.csv")

```

# October

```{r}
october_leads <- read_csv("october-dm-data/october_leads.csv")
inboundcall_oct <- inboundcall |>
  filter(str_detect(Campaign_Tags, "oct"))
```

```{r}
october_leads |> 
  group_by(MQL, SQL, CW) |> 
  summarise(counts=n())
```

```{r}
inboundcall_oct |> 
  group_by(Campaign_Tags) |> 
  summarise(count=n())
```


# November 

```{r}
november_leads <- read_csv("november-dm-data/november_leads.csv")

inboundcall_nov <- inboundcall |>
  filter(str_detect(Campaign_Tags, "nov"))
  # distinct(Phone_IB_Call, .keep= TRUE)
```

```{r}
november_leads |> 
  group_by(MQL, SQL, CW) |> 
  summarise(counts=n())

inboundcall_nov |> 
  group_by(Campaign_Tags) |> 
  summarise(count=n())
```

# December

```{r cars}
december_leads <- read_csv("december-dm-data/december_leads.csv")
inboundcall_dec <- inboundcall |>
  filter(str_detect(Campaign_Tags, "dec"))
  # distinct(Phone_IB_Call, .keep= TRUE)
```

```{r}
december_leads |> 
  group_by(MQL, SQL, CW) |> 
  summarise(counts=n())

inboundcall_dec |> 
  group_by(Campaign_Tags) |> 
  summarise(count=n())
```



```{r}
december_leads <- december_leads |> 
  mutate(Campaign_Group = "December Leads")

november_leads <- november_leads |> 
    mutate(Campaign_Group = "November Leads")

october_leads <- october_leads |> 
    mutate(Campaign_Group = "October Leads")


sfdc_leads__c = bind_rows(december_leads, november_leads, october_leads)

sfdc_leads__c <- sfdc_leads__c |> 
  select( "Campaign_Group", "flow", "types", "CW", "SQL", "MQL", "Campaign_Tags","Campaign_by_Month", everything())

write_csv(sfdc_leads__c,"clean-data/sfdc_leads__c.csv",na="")
```

